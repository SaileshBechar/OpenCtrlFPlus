

\subsection{SGS Turbulence}

To model SGS turbulence, we employ the scale separation technique, where a large-scale flow is governed by filtered hydrodynamical equations, whereas small-scale motions are described by an additional hydrodynamical field. In our simulation we use the SGS model described by Schmidt et al. (2014) for application in cosmological AMR simulations. Here we briefly outline the main components and properties of this model. The more extensive description can be found in the original paper by Schmidt et al. (2014).

Model equations follow from applying a spatial filter of scale $\Delta$, which we take to correspond to the grid cell scale, to ordinary hydrodynamical equations. The resulting set of equations governs flow on resolved scales $(>\Delta)$ and contains additional terms and a new equation for SGS turbulent energy density $K$ :

$$\frac{\partial}{\partial t} K+\nabla_{i}\left(u_{i} K\right)=-P_{K} \nabla_{i} u_{i}-\varepsilon+\tau_{i j} \nabla_{i} u_{j}+\nabla_{i} F_{i}+S_{\mathrm{SN}},$$

where $u_{i}$ is resolved gas velocity, $P_{K}=2 K / 3$ is turbulent pressure, $\varepsilon$ is a rate of decay into thermal energy, $\tau_{i j} \nabla_{i} u_{j}$ is viscous production by cascade from resolved scales, $\nabla_{i} F_{i}$ is turbulent diffusion, and $S_{\mathrm{SN}}$ is sourcing by SNe (see Section 2.3 for the description of $S_{\mathrm{SN}}$ ). The total velocity dispersion of gas motions on unresolved scales is then derived from $K$ as $\sigma=\sqrt{2 K / \rho}$.

Note that the SGS turbulent energy is very similar to thermal energy, as the latter results from integrating particles' kinetic energies over velocity space in the derivation of hydrodynamical equations from the Boltzmann equation. For instance, the first term on the right-hand side of Equation (2) is equivalent to the $P d V$ term in the equation for thermal energy. This term implies that as gas contracts (expands) $P_{K}$ does work and turbulent energy increases (decreases) similarly to thermal energy (Robertson \& Goldreich 2012). Change of $K$ in this process depends on the local compression rate $\left(-\nabla_{i} u_{i}\right)$.

Likewise, the $\varepsilon$ and $\tau_{i j} \nabla_{i} u_{j}+S_{\mathrm{SN}}$ are equivalent to the cooling and heating terms in the thermal energy equation. We follow Schmidt et al. (2014) and assume exponential decay of $K$ into thermal energy over the timescale close to the turbulent cell crossing time, $t_{\text {dec }} \sim \Delta / \sigma$. Numerical studies of decaying MHD turbulence generally confirm fast dissipation over the crossing time in both subsonic and supersonic regimes (e.g., Gammie \& Ostriker 1996; Mac Low et al. 1998; Stone et al. 1998; Kim \& Basu 2013).

Equations for resolved gas momentum and energy also include terms related to nonthermal pressure $\left(P_{K}\right)$, turbulent viscosity $\left(\tau_{i j}\right)$, and diffusion (similar to $\nabla_{i} F_{i}$ ). The latter two terms are analogous to molecular viscosity and thermal conduction that appear in the hydrodynamical equations when different moments of the Boltzmann equation are integrated over velocity space.

The equations of viscous hydrodynamics and SGS turbulence both require closure relations for these transport terms in order to become solvable. In both cases these closure relations cannot be derived from the first principles and are chosen empirically. One of the common choices for the SGS turbulence is to adopt the closure relations similar to those used for the usual viscosity and thermal conduction. Physically, this approach assumes that energy and momentum are transported on the filtering scale $\Delta$ mainly by the eddies of size $\Delta$, i.e., the largest unresolved eddies. Models that employ this assumption are known as the Large-Eddy Simulations and are widely used for simulations of both incompressible (Sagaut 2006) and supersonic (Garnier et al. 2009) turbulent flows (see also Schmidt 2014, for a recent overview in the astrophysical context).

In our simulation for the turbulent stress tensor $\tau_{i j}$ we use the large-eddy viscosity closure, given by Equation (8) of Schmidt $\&$ Federrath (2011) with $C_{2}=0$ and $C_{1}=0.095$, appropriate for the sub- and transonic regimes. Our choice is justified by the fact that viscous production of turbulence in our simulated disk is important mainly in warm diffuse gas, where SGS turbulence is subsonic and gas is only weakly compressible (see Section 3.1). We checked that our implementation of the SGS model with such closure reproduces the correct distribution of $K$ in a low-resolution isotropic developed turbulence box simulation, when compared to a high-resolution direct simulation.

In the adopted closure, $\tau_{i j}$ depends on the local gradients of the resolved velocity field, and these gradients are interpreted as an onset of turbulent cascade on scale $\Delta$. Therefore, in this model turbulence can be artificially produced by large-scale velocity gradients (e.g., differential rotation, disk/halo interface, etc.). In order to suppress this spurious production, Schmidt et al. (2014) suggest temporal averaging of a simulated flow, so that $\tau_{i j}$ depends only on the gradients of the fluctuating velocity part, in the so-called "shear-improved" closure, first introduced by Leveque et al. (2007). In our simulation we adopt exponential temporal filtering with a time window $t_{\mathrm{si}}=10 \mathrm{Myr}$, i.e., turbulent energy is produced by cascade from velocity perturbations that develop faster than $t_{\mathrm{si}}$. We choose the value $t_{\mathrm{si}}=10 \mathrm{Myr}$ to filter out the differential rotation, on the one hand, and to capture various developing disk instabilities, on the other hand. We checked that our results are not sensitive to a change of $t_{\mathrm{si}}$ by a factor of 2 .

Although the SGS turbulence has a number of parameters, as described above, these parameters are calibrated using turbulence simulations and are not varied in galaxy formation simulations. In this sense, they do not really add tunable free parameters in such simulations. They do affect the solution, however, as a particular choice of the closure relation forms and their parameters controls all interactions between resolved and unresolved scales and may depend on flow configuration and turbulent Mach number. Generally, this might be considered as an important limitation of our model, as the specific closure adopted for our simulation was calibrated to reproduce the results of high-resolution simulations of developed isotropic transonic turbulence, while we apply it to a sheared gas flow in a stratified disk. However, we argue that this approach is still viable for prediction of the turbulent velocities in cold star-forming gas. Specifically, we checked that the resulting distribution of turbulent energy in cold gas is not sensitive to a particular choice of $\tau_{i j}$ parameterization. This is because the turbulent energy in this gas is mostly determined by the interplay between heating by compression and viscous dissipation into heat (see Section 3.1). Both these effects are insensitive to turbulent Mach number as indicated by numerical simulations of developed turbulence (Mac Low et al. 1998; Robertson \& Goldreich 2012).

One important limitation of our model is an assumption that unresolved turbulence on scale $\Delta$ is in the inertial regime. This 